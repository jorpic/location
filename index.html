<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN" "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd"><html><head><title>Определение местоположения</title><meta name="viewport" content="width=device-width, initial-scale=1"><meta charset="utf-8"><style>body{flex-direction:column;height:100vh;max-width:50rem;margin:auto;font-family:sans-serif}.bar,body{display:flex}.bar{justify-content:space-between;align-items:center;background-color:grey;color:#fff}.bar,.info{padding:.5em}.info{display:none;background-color:ivory}.err{background-color:#ffe4e1}.done{background-color:#f5fffa}.info p{display:inline}button{float:right;outline:none;background:none;border:3px solid #000;border-radius:.7em;padding:.5em;margin:.75em;min-width:12em}button:active{transform:scale(.95)}#content{display:flex;flex:1}</style></head><body><div class="bar"><img width="48" height="48" src="https://bmw.com/etc.clientlibs/settings/wcm/designs/bmwcom/base/resources/ci2020/img/logo-en.png">BMW Roadside Assistance</div><div class="info welcome"><p>Нажмите кнопку, чтобы определить Ваше местоположение.</p><button onclick="getCoords()">Начать</button></div><div class="info err"><p>Что-то пошло не так.</p><button onclick="getCoords()">Попробовать ещё</button></div><div class="info ok"><p>Пожалуйста, уточните Ваше местоположение.</p><br><p id="info1"></p><br><p id="info2"></p><button onclick="sendCoords()">Уточнить</button></div><div class="info done"><p>Спасибо, мы уже спешим к Вам.</p></div><div id="content"><svg id="svg" xmlns="http://www.w3.org/2000/svg" version="1.1" width="10" height="10"><g id="tiles"></g><g id="pin"><g transform="translate(-12 -36) scale(0.5)" fill="#880096"><path d="M24,0 C11,0 0,10 0,22 C0,35 10,50 24,72 C37,50 48,35 48,22 C48,10 36,0 24,0 L24,0 Z M24,33 C19,33 15,28 15,24 C15,19 19,15 24,15 C28,15 33,19 33,24 C33,28 28,33 24,33 L24,33 Z"></path></g></g></svg></div><script>var t=function(t,o,n){return o.split(" ").map(function(o){return t.addEventListener(o,n,!1)})},o=function(t){return document.getElementById(t)},n=o("info"),e=o("svg"),a=16,i=Math.pow(2,a-1),r=255,c=Math.PI;function l(t){var o=t.lon,n=t.lat*c/180;return{x:(o+180)/180*i,y:(1-Math.log(Math.tan(n)+1/Math.cos(n))/c)*i}}function u(t){var o=t.x,n=t.y;return{lon:180*(o/i-1),lat:180*Math.atan(Math.sinh(c*(1-n/i)))/c}}var d={tiles:o("tiles"),loadedTiles:{},pin:o("pin"),dx:0,dy:0,originX:0,originY:0};function s(o){d.lon=o.lon,d.lat=o.lat;var n=l(o),e=n.x,a=n.y,i=Math.floor(e),c=Math.floor(a);d.originX=i,d.originY=c,h(r*(e-i),r*(a-c)),t(window,"orientationchange resize",function(){return h(0,0)})}function h(t,n){d.dx+=t,d.dy+=n;var i=o("content"),c=Math.floor(i.clientWidth/2),l=Math.floor(i.clientHeight/2);e.setAttribute("width",i.clientWidth),e.setAttribute("height",i.clientHeight),d.pin.setAttribute("transform","translate(".concat(c," ").concat(l,")")),d.tiles.setAttribute("transform","translate(".concat(c-d.dx," ").concat(l-d.dy,")"));var s=d.originX+d.dx/r,h=d.originY+d.dy/r,f=u({x:s,y:h}),g=f.lon,p=f.lat;o("info2").textContent="(".concat(p.toFixed(6),", ").concat(g.toFixed(6),")");for(var v=0;v<9;++v){var m=v%3-1,w=Math.floor(v/3)-1,M=[a,Math.floor(s)+m,Math.floor(h)+w].join("/");if(!d.loadedTiles[M]){var x=document.createElementNS("http://www.w3.org/2000/svg","image"),y="abc"[Math.floor(12*Math.random())%3];x.setAttributeNS("http://www.w3.org/1999/xlink","xlink:href","https://".concat(y,".tile.openstreetmap.org/").concat(M,".png")),x.setAttribute("width",r),x.setAttribute("height",r),x.setAttribute("x",r*(Math.floor(s)-d.originX+m)),x.setAttribute("y",r*(Math.floor(h)-d.originY+w)),d.tiles.appendChild(x),d.loadedTiles[M]=x}}}var f=!0;function g(){var o,n,a=function(t){return t.touches?t.touches[0]:t},i=!1;t(e,"mousedown touchstart",function(t){t.preventDefault(),i=!0;var e=a(t);o=e.pageX,n=e.pageY}),t(e,"mousemove touchmove",function(t){if(f&&i){var e=a(t);h(o-e.pageX,n-e.pageY),o=e.pageX,n=e.pageY}}),t(document.body,"mouseup",function(t){i=!1})}function p(t){var n={lat:t.coords.latitude,lon:t.coords.longitude,accuracy:t.coords.accuracy};o("info1").textContent="(".concat(n.lat.toFixed(6),", ").concat(n.lon.toFixed(6),")")+" с точностью ±".concat(n.accuracy.toFixed(1)," метров."),m("ok"),s(n),g()}function v(t){p({coords:{latitude:55.583357,longitude:37.596508,accuracy:11}})}function m(t){for(var o=document.getElementsByClassName("info"),n=0;n<o.length;++n)o[n].style.display=o[n].classList.contains(t)?"block":"none"}window.getCoords=function(){navigator.geolocation.getCurrentPosition(p,v)},window.sendCoords=function(){f=!1,m(Math.random()>.5?"done":"err")},m("welcome");</script></body></html>