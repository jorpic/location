<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN" "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd"><html><head><title>− Определение местоположения</title><meta name="viewport" content="width=device-width, initial-scale=1"><meta charset="utf-8"><style>body{display:flex;flex-direction:column;height:100vh;max-width:50rem;margin:auto;font-family:sans-serif}.bar{background-color:#1e90ff;color:#fff}.bar,.info{padding:.5em}.info{display:none;background-color:azure}.err{background-color:#ffe4e1}.done{background-color:#f5fffa}.info p{display:inline}button{float:right;outline:none;background:none;border:3px solid #000;border-radius:.7em;padding:.5em;margin:.75em;min-width:12em}button:active{transform:scale(.95)}svg{display:flex;flex:1}</style></head><body><div class="bar">Лого и название программы</div><div class="info welcome"><p>Нажмите кнопку, чтобы определить ваше местоположение.</p><button onclick="getCoords()">Начать</button></div><div class="info err"><p>Что-то пошло не так.</p><button onclick="getCoords()">Попробовать ещё</button></div><div class="info ok"><p>Ура! Мы определили ваше местоположение, откорректируйте его если надо и не забудьте отправить.</p><br><p id="info1"></p><br><p id="info2"></p><button onclick="sendCoords()">Отправить</button></div><div class="info done"><p>Спасибо, мы уже спешим к вам.</p></div><svg id="svg" xmlns="http://www.w3.org/2000/svg" version="1.1"><g id="tiles"></g><g id="pin"><g transform="translate(-12 -36) scale(0.5)" fill="#880096"><path d="M24,0 C11,0 0,10 0,22 C0,35 10,50 24,72 C37,50 48,35 48,22 C48,10 36,0 24,0 L24,0 Z M24,33 C19,33 15,28 15,24 C15,19 19,15 24,15 C28,15 33,19 33,24 C33,28 28,33 24,33 L24,33 Z"></path></g></g></svg><script>var t=function(t,n,o){return n.split(" ").map(function(n){return t.addEventListener(n,o,!1)})},n=function(t){return document.getElementById(t)},o=n("info"),e=n("svg"),a=16,r=Math.pow(2,a-1),c=255,i=Math.PI;function l(t){var n=t.lon,o=t.lat*i/180;return{x:(n+180)/180*r,y:(1-Math.log(Math.tan(o)+1/Math.cos(o))/i)*r}}function u(t){var n=t.x,o=t.y;return{lon:180*(n/r-1),lat:180*Math.atan(Math.sinh(i*(1-o/r)))/i}}var s={tiles:n("tiles"),pin:n("pin"),dx:0,dy:0};function d(n){s.lon=n.lon,s.lat=n.lat;var o=l(n),e=o.x,r=o.y,i=Math.floor(e),u=Math.floor(r);s.originX=i,s.originY=u;for(var d=0,g=[-1,0,1];d<g.length;d++)for(var h=g[d],p=0,v=[-1,0,1];p<v.length;p++){var m=v[p],w=document.createElementNS("http://www.w3.org/2000/svg","image"),y="abc"[Math.floor(12*Math.random())%3];w.setAttributeNS("http://www.w3.org/1999/xlink","xlink:href","https://".concat(y,".tile.openstreetmap.org/").concat(a,"/").concat(i+h,"/").concat(u+m,".png")),w.setAttribute("x",c*h),w.setAttribute("y",c*m),s.tiles.appendChild(w)}f(c*(e-i),c*(r-u)),t(window,"orientationchange resize",function(){return f(0,0)})}function f(t,o){s.dx+=t,s.dy+=o;var a=Math.floor(e.clientWidth/2),r=Math.floor(e.clientHeight/2);s.pin.setAttribute("transform","translate(".concat(a," ").concat(r,")")),s.tiles.setAttribute("transform","translate(".concat(a-s.dx," ").concat(r-s.dy,")"));var i=u({x:s.originX+s.dx/c,y:s.originY+s.dy/c}),l=i.lon,d=i.lat;n("info2").textContent="(".concat(d.toFixed(6),", ").concat(l.toFixed(6),")")}var g=!0;function h(){var n,o,a=function(t){return t.touches?t.touches[0]:t},r=!1;t(e,"mousedown touchstart",function(t){t.preventDefault(),r=!0;var e=a(t);n=e.pageX,o=e.pageY}),t(e,"mousemove touchmove",function(t){if(g&&r){var e=a(t);f(n-e.pageX,o-e.pageY),n=e.pageX,o=e.pageY}}),t(document.body,"mouseup",function(t){r=!1})}function p(t){var o={lat:t.coords.latitude,lon:t.coords.longitude,accuracy:t.coords.accuracy};n("info1").textContent="(".concat(o.lat,", ").concat(o.lon,")")+" с точностью ±".concat(o.accuracy.toFixed(1)," метров."),m("ok"),d(o),h()}function v(t){m("err")}function m(t){for(var n=document.getElementsByClassName("info"),o=0;o<n.length;++o)n[o].style.display=n[o].classList.contains(t)?"block":"none"}window.getCoords=function(){navigator.geolocation.getCurrentPosition(p,v)},window.sendCoords=function(){g=!1,m(Math.random()>.5?"done":"err")},m("welcome");</script></body></html>