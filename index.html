<!DOCTYPE html><html><head><title>− Определение местоположения</title><meta name="viewport" content="width=device-width, initial-scale=1"><meta charset="utf-8"><style>*{margin:0;padding:0}body{flex-flow:column;height:100vh;max-width:50rem;margin:auto}body,header{display:flex}header{flex-flow:row wrap;justify-content:space-between;align-items:center;padding:.5em}@media (orientation:portrait){header *{margin:.5em 1em}header button{max-width:40%}header .info{order:1;width:100%}}content{flex-grow:1;border:1px solid green}svg{width:100%;height:100%;border:1px solid red}</style></head><body><header><h1>VW</h1><p class="info">Помощь на дорогах</p><button>Отправить координаты</button></header><content id="map"><svg id="svg"><g id="tiles"></g><g id="pin"><g transform="translate(-12 -36) scale(0.5)" fill="#880096"><path d="M24,0 C11,0 0,10 0,22 C0,35 10,50 24,72 C37,50 48,35 48,22 C48,10 36,0 24,0 L24,0 Z M24,33 C19,33 15,28 15,24 C15,19 19,15 24,15 C28,15 33,19 33,24 C33,28 28,33 24,33 L24,33 Z"></path></g></g></svg></content><script>var t=function(t,n,e){return t.addEventListener(n,e,!1)},n=function(t){return document.getElementById(t)},e=n("info"),o=n("map"),a=n("svg"),c=16,i=Math.pow(2,c-1),r=255,l=Math.PI;function u(t){var n=t.lon,e=t.lat*l/180;return{x:(n+180)/180*i,y:(1-Math.log(Math.tan(e)+1/Math.cos(e))/l)*i}}function h(t){var n=t.x,e=t.y;return{lon:180*(n/i-1),lat:180*Math.atan(Math.sinh(l*(1-e/i)))/l}}var s={tiles:n("tiles"),pin:n("pin"),dx:0,dy:0},f=Math.floor(a.clientWidth/2),d=Math.floor(a.clientHeight/2);function g(t){for(var n=u(t),e=n.x,o=n.y,a=Math.floor(e),i=Math.floor(o),l=0,h=[-1,0];l<h.length;l++)for(var g=h[l],m=0,v=[-1,0];m<v.length;m++){var w=v[m],M=document.createElementNS("http://www.w3.org/2000/svg","image"),x="abc"[Math.floor(12*Math.random())%3];M.setAttributeNS("http://www.w3.org/1999/xlink","xlink:href","https://".concat(x,".tile.openstreetmap.org/").concat(c,"/").concat(a+g,"/").concat(i+w,".png")),M.setAttribute("x",r*g),M.setAttribute("y",r*w),s.tiles.appendChild(M)}s.pin.setAttribute("transform","translate(".concat(f," ").concat(d,")")),p(r*(e-a),r*(o-i))}function p(t,n){s.dx+=t,s.dy+=n,s.tiles.setAttribute("transform","translate(".concat(f-s.dx," ").concat(d-s.dy,")"))}function m(){var n,e,o=function(t){return t.touches?t.touches[0]:t},c=!1;function i(t){t.preventDefault(),c=!0;var a=o(t);n=a.pageX,e=a.pageY}function r(t){if(c){var a=o(t);p(n-a.pageX,e-a.pageY),n=a.pageX,e=a.pageY}}t(a,"mousedown",i),t(a,"touchstart",i),t(a,"mousemove",r),t(a,"touchmove",r),t(document.body,"mouseup",function(t){c=!1})}function v(t){t.coords.latitude,t.coords.longitude,t.coords.accuracy,new Date,t.timestamp,Date.now()}function w(t){console.log(t),e.textContent="Не удалось определить координаты: "+t.message}function M(){a.clientWidth=o.clientWidth,a.clientHeight=o.clientHeight,console.log({w:a.clientWidth,h:a.clientHeight})}g({lat:55.583357,lon:37.596508}),m(),M();</script></body></html>